{"model_name_or_path": "deepseek-chat__t-0.00__p-1.00__c-2.00___swe_bench_verified_test", "instance_id": "django__django-16612", "model_patch": "diff --git a/django/contrib/admin/sites.py b/django/contrib/admin/sites.py\nindex 61be31d890..eb8ea05590 100644\n--- a/django/contrib/admin/sites.py\n+++ b/django/contrib/admin/sites.py\n@@ -453,7 +453,11 @@ class AdminSite:\n                 pass\n             else:\n                 if getattr(match.func, \"should_append_slash\", True):\n-                    return HttpResponsePermanentRedirect(\"%s/\" % request.path)\n+                    query_string = request.META.get('QUERY_STRING', '')\n+                    redirect_url = \"%s/\" % request.path\n+                    if query_string:\n+                        redirect_url += \"?\" + query_string\n+                    return HttpResponsePermanentRedirect(redirect_url)\n         raise Http404\n \n     def _build_app_dict(self, request, label=None):\ndiff --git a/test_redirect.py b/test_redirect.py\nnew file mode 100644\nindex 0000000000..bc3767a3c8\n--- /dev/null\n+++ b/test_redirect.py\n@@ -0,0 +1,25 @@\n+from django.http import HttpRequest, HttpResponsePermanentRedirect\n+from django.conf import settings\n+\n+# Minimal settings configuration\n+settings.configure(\n+    APPEND_SLASH=True,\n+    DEFAULT_CHARSET='utf-8'\n+)\n+\n+def test_redirect():\n+    request = HttpRequest()\n+    request.path = \"/admin/auth/foo\"\n+    request.path_info = \"/admin/auth/foo\"\n+    request.META['QUERY_STRING'] = \"id=123\"\n+    \n+    if settings.APPEND_SLASH and not request.path.endswith(\"/\"):\n+        query_string = request.META.get('QUERY_STRING', '')\n+        redirect_url = \"%s/\" % request.path\n+        if query_string:\n+            redirect_url += \"?\" + query_string\n+        return HttpResponsePermanentRedirect(redirect_url)\n+    \n+    return \"No redirect\"\n+\n+print(test_redirect())\n\\ No newline at end of file\n"}