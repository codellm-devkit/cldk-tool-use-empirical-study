{"model_name_or_path": "deepseek-chat__t-0.00__p-1.00__c-2.00___swe_bench_verified_test", "instance_id": "pydata__xarray-3677", "model_patch": "diff --git a/xarray/core/dataset.py b/xarray/core/dataset.py\nindex ac0a923d..a59a3918 100644\n--- a/xarray/core/dataset.py\n+++ b/xarray/core/dataset.py\n@@ -3604,6 +3604,9 @@ class Dataset(Mapping, ImplementsDatasetReduce, DataWithCoords):\n             If any variables conflict (see ``compat``).\n         \"\"\"\n         _check_inplace(inplace)\n+        from .dataarray import DataArray\n+        if isinstance(other, DataArray):\n+            other = other.to_dataset()\n         merge_result = dataset_merge_method(\n             self,\n             other,\n"}